{"id":"tome-1kw","title":"Add bulk 'Add Books' feature to shelf detail pages","description":"Implement bulk book management for shelves by adding an 'Add Books' feature to shelf detail pages.\n\n## Context\n- Related to #180 (Bulk shelf management)\n- PR #235 added shelf functionality but only supports adding individual books\n- Need efficient way to populate shelves with multiple books at once\n\n## Approach\nImplement 'Add Books to Shelf' feature on `/shelves/[id]` pages (Option 2 from analysis).\nThis is Phase 1 of a phased approach - validates the shelf-first workflow before adding complexity to /library page.\n\n## Implementation Plan\n\n### Phase 1: Backend Foundation\n- Task 1.1: Create bulk add API endpoint (POST /api/shelves/[id]/books/bulk)\n- Task 1.2: Extend shelf service with addBooksToShelf method\n- Task 1.3: Add excludeShelfId filter to book repository\n\n### Phase 2: Frontend API Layer\n- Task 2.1: Extend shelfApi with addBooks method\n- Task 2.2: Add types for bulk operations\n- Task 2.3: Extend useShelfBooks hook with addBooksToShelf\n\n### Phase 3: Frontend UI Components\n- Task 3.1: Create AddBooksToShelfModal component (search-first approach)\n- Task 3.2: Update shelf detail page with Add Books button\n\n### Phase 4: Testing\n- Task 4.1: Write API endpoint tests\n- Task 4.2: Write repository filter tests\n- Task 4.3: Update hook tests\n- Task 4.4: Write component tests\n\n## Key Features\n- 'Add Books' button on shelf detail page\n- Modal with search-first approach (min 2 chars)\n- Search/filter by title, author, status, rating, tags\n- Multi-select checkboxes with \"Select All\" (visible only)\n- Books already on shelf automatically excluded\n- Batch add selected books to shelf\n- Desktop modal + mobile full-screen responsive\n\n## Technical Details\n- Search triggers: 2+ characters OR any filter applied\n- No automatic list on open (empty state with search prompt)\n- Books on current shelf invisible (excludeShelfId filter)\n- Sort order: Books added in search result order\n- Select All: Only visible books (first 50)\n- No max selection warning\n\n## Files to Create\n- app/api/shelves/[id]/books/bulk/route.ts\n- components/ShelfManagement/AddBooksToShelfModal.tsx\n- __tests__/api/shelves/[id]/books/bulk.test.ts\n- __tests__/components/ShelfManagement/AddBooksToShelfModal.test.tsx\n\n## Files to Modify\n- lib/services/shelf.service.ts - Add addBooksToShelf method\n- lib/api/domains/shelf/api.ts - Add addBooks method\n- lib/api/domains/shelf/types.ts - Add bulk operation types\n- hooks/useShelfBooks.ts - Add addBooksToShelf method\n- lib/repositories/book.repository.ts - Add excludeShelfId filter\n- app/shelves/[id]/page.tsx - Add button and modal\n- __tests__/hooks/useShelfBooks.test.ts - Add tests\n\n## Success Criteria\n- Can search/filter books and select multiple\n- Books on shelf are auto-excluded (invisible)\n- Selected books added to shelf in single operation\n- Works on desktop and mobile\n- All tests pass (99+)\n\n## Estimated Effort\nBackend: 3 hours\nFrontend API: 1.5 hours\nUI Components: 5 hours\nTesting: 4 hours\nTotal: ~13-14 hours (1.5-2 days)\n\n## Branch\nfeature/bulk-add-books-to-shelf","status":"in_progress","priority":2,"issue_type":"feature","created_at":"2026-01-07T10:52:33.512583507-05:00","updated_at":"2026-01-07T14:27:36.200492667-05:00","created_by":"mason"}
{"id":"tome-3bh","title":"Sort shelf books by author last name instead of first name","description":"On /shelves/:id page, when sorting by title column, sort by author's last name rather than first name","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T08:01:59.313670646-05:00","updated_at":"2026-01-07T08:11:35.656381666-05:00","closed_at":"2026-01-07T08:11:35.656381666-05:00","close_reason":"Closed","created_by":"mason"}
{"id":"tome-4fa","title":"Improve test coverage for shelf feature","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T09:35:10.80329401-05:00","updated_at":"2026-01-07T09:54:58.923908862-05:00","closed_at":"2026-01-07T09:54:58.923908862-05:00","close_reason":"Improved test coverage for shelf feature. Added 30 tests across DraggableBookTable, ShelfIconPicker, and useShelfBooks. Coverage improved: useShelfBooks (76.28% → 81.44%), ShelfIconPicker (4.76% → 80%). All tests passing.","created_by":"mason"}
{"id":"tome-7to","title":"Add multi-select bulk delete for shelf books","description":"Implement multi-select mode with checkboxes allowing users to select multiple books and delete them in bulk from shelves. Includes backend API endpoint, optimized repository method with transaction, frontend components with select mode, and floating action bar.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T08:19:07.193806796-05:00","updated_at":"2026-01-08T08:30:08.872831559-05:00","closed_at":"2026-01-08T08:30:08.872831559-05:00","close_reason":"Closed","created_by":"mason"}
{"id":"tome-d1a","title":"Add comprehensive test coverage for shelf feature","description":"Coverage gaps identified in feature/goodreads-style-shelves branch:\n- lib/services/shelf.service.ts (120 missed lines, 4.72% coverage)\n- app/api/shelves/[id]/route.ts (53 missed lines, 21.43% coverage)  \n- lib/repositories/shelf.repository.ts (51 missed lines, 44.44% coverage)\n- hooks/useShelfBooks.ts (21 missed lines, 65.63% coverage)\n- components/Library/LibraryFilters.tsx (23 missed lines, 50.65% coverage)\n- components/Books/DraggableBookTable.tsx (28 missed lines, 50.59% coverage)\n\nNeed to add:\n1. ShelfService unit tests\n2. API route integration tests\n3. Hook tests (useShelfBooks, useShelfManagement)\n4. Component tests (LibraryFilters, DraggableBookTable, ShelfIconPicker)\n5. Additional repository edge case tests","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T09:18:59.443872672-05:00","updated_at":"2026-01-07T09:30:33.400033634-05:00","closed_at":"2026-01-07T09:30:33.400033634-05:00","close_reason":"Closed","created_by":"mason"}
{"id":"tome-fdl","title":"Create generic fanned book covers component with expanded display","description":"Extract fanned book covers into reusable component, remove 3-cover limit, and implement on /series and /shelves pages","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T08:26:26.597106399-05:00","updated_at":"2026-01-07T08:37:56.645644896-05:00","closed_at":"2026-01-07T08:37:56.645644896-05:00","close_reason":"Closed","created_by":"mason"}
